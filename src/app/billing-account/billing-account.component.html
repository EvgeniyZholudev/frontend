<div class="container">
  <div class="justify-content-center">
    <table class="table text-center">
      <thead class="thead-dark">
      <tr>
        <th scope="col">НАЗВАНИЕ</th>
        <th scope="col">БАЛАНС</th>
        <th scope="col">КОЛ-ВО ПОДПИСОК</th>
        <th scope="col">ПЛАТА</th>
        <th scope="col">СТАТУС</th>
        <th scope="col"></th>
      </tr>
      </thead>
      <tbody class="table-dark">
      <tr *ngFor="let billingAccount of authService.authorizedUser.billingAccounts"
      >
        <td scope="row">{{billingAccount.name}}</td>
        <td>{{billingAccount.balance}} RUB</td>
        <td>{{billingAccount.subscripts.length}}<a class="btn text-primary"
                                                   (click)="openModal(subsModal, billingAccount)">
          (Показать)</a></td>
        <td>{{billingAccountService.countPricePerDay(billingAccount)}} RUB/д.</td>
        <td>{{billingAccountService.getSelectedBAStatus()}}</td>
        <td>
          <button type="button" class="btn btn-primary" [disabled]="!billingAccount.status">
            Удалить
          </button>
          <button type="button" class="btn btn-primary ml-3" (click)="openModal(replenishBalance, billingAccount)">
            Пополнить баланс
          </button>
        </td>
      </tr>
      </tbody>
    </table>

  </div>
  <button type="button" class="btn btn-primary">Добавить аккаунт
  </button>
</div>

<ng-template #subsModal>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Подписки выбранного аккаунта</h4>
    <button type="button" class="close pull-right"
            aria-label="Close" (click)="closeModal()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="form-group justify-content-center">
      <table class="table table-hover border-bottom">
        <thead class="thead-dark">
        <tr>
          <th scope="col">ПОДПИСКА</th>
          <th scope="col">ОПИСАНИЕ</th>
          <th scope="col">ЦЕНА</th>
          <th scope="col"></th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let subscript of billingAccountService.selectedBillingAccount.subscripts">
          <td scope="row">{{subscript.name}}</td>
          <td>{{subscript.description}}</td>
          <td>{{subscript.pricePerDay}} RUB/д.</td>
          <td>
            <button type="button" class="btn btn-primary d-none d-lg-inline-block mt-2"
                    [disabled]="!billingAccountService.selectedBillingAccount.status">Отписаться
            </button>
          </td>
        </tr>
        </tbody>
      </table>
      <h6>Плата за день: {{billingAccountService.countPricePerDay(billingAccountService.selectedBillingAccount)}}</h6>
    </div>
  </div>
</ng-template>

<ng-template #replenishBalance>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Пополнить баланс на выбранном аккаунте</h4>
    <button type="button" class="close pull-right"
            aria-label="Close" (click)="closeModal()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="form-group justify-content-center">
      <h6>Имя аккаунта: {{billingAccountService.selectedBillingAccount.name}}</h6>
      <h6>Баланс: {{billingAccountService.selectedBillingAccount.balance}}</h6>
      <h6>Статус: {{billingAccountService.getSelectedBAStatus()}}</h6>
      <h6>Плата за день: {{billingAccountService.countPricePerDay(billingAccountService.selectedBillingAccount)}}</h6>
      <p></p>
      <div class="form-group">
        <label for="exampleForm2">Введите сумму:</label>
        <input type="number" id="exampleForm2" name="sum" [(ngModel)]="inputSum" #sum="ngModel"
               class="form-control w-50" required pattern="[1-9]{1}[0-9]{0,6}">
        <div [hidden]="sum.untouched || sum.valid" class="alert alert-danger w-50">
          Вы ввели неверное число или вовсе не число
        </div>
      </div>

      <button type="button" class="btn btn-primary d-none d-lg-inline-block mt-2" [disabled]="sum.invalid">Пополнить
      </button>
    </div>
  </div>
</ng-template>
